<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Windows11でデスクトップにスリープアイコンを作る。クリック１つでｐｃをスリープ。休止ではない。</title>
</head>
<body>
    <h1>Windows11でデスクトップにスリープアイコンを作り、クリック1つでPCをスリープ状態にする。休止じゃないよー。<br>
        .batファイルと.ps1ファイルを使う。powershellでalt+f4以降の一連の動作を自動化＞
    </h1>
        <p>
            私のPCにはスリープボタンなるものがないので、ボタン一つでスリープにしたいと思ったわけです。ラップトップなので、設定でカバーを閉じたらスリープにすることもできるのですが、
            それだと何かダウンロードしているときにカバーを閉じられないのです。なので、カバーを閉じたときの動作を、何もしない、に設定して画面の電源をオフにしているのです。カバーを閉じると、
            画面が消えて節電になるのでね。<br>

        </p>
    <h2>いろいろネットで探したが、休止の方法しか見つからなかった。ので、バッチファイルを自作。<br>
        具体的には、こうだ。<br>
        
    </h2>
        <p>
         ALT＋F4、の動作からのスリープ発動。これを、自動で行う。（WINキー＋Xからという方法もあったが、WIN＋Xを実現できなかったため、CTRL+ESC+Xができなかった断念）<br>
        .batファイルと.ps1ファイルを作成して実現。いろいろ気になる点は残ったが、目的の「アイコンをクリックして、スリープする」はできたので、良しとする。<br>
        これがそのファイル。<br>
        1つ目は、クリックするとダウンロードされるようです。<br>
        2つ目は、windows defenderに防がれるようです。が、ダウンロードはされているようです。<br>
        <a href="https://dancingonwhiteboard.github.io\webpages\sleep\sleep1.ps1">sleep1.ps1</a><br>
        sleep1.ps1というファイル名。<br>
        内容はこんな感じ。<br>
        <a href="https://dancingonwhiteboard.github.io\webpages\sleep\sleep1.txt">sleep1.txt</a><br>

        <a href="https://dancingonwhiteboard.github.io\webpages\sleep\スリープ.bat">スリープ</a><br>
        スリープ.batというファイル名だが、お好きに変更どうぞ。<br>
        拡張子を.txtにしました。使用時は .bat　に変更してください。<br>
        <a href="https://dancingonwhiteboard.github.io\webpages\sleep\スリープ.txt">スリープ</a><br>
        コピーして使ってください。ファイル名はなんでもいいですが、拡張子を.batにして下さしい。<br>

        相対アドレスを使っているので、同じディレクトリにおいてください。デスクトップに2つとも置けば問題ないでしょう。<br>
        秒数は2秒となっていますが、1秒でもいいかもしれませんね。端末の性能次第でしょうか？
        </p>
<h2>
    バッチファイルの説明
</h2>
    <p>
        powershellでの操作（ＡＬＴ＋Ｆ４＜ウィンドウズのシャットダウンポップアップ＞、ＵＰ＜休止＞，ＵＰ＜スリープ＞、ＥＮＴＥＲ）を.batファイルで呼び出し、自動で実行。
    </p>
<h2>
    おわりに
</h2>
    <p>
        さっき気づいたのですが、電源ボタンでスリープできるようなのです。そういう設定にはしていたんですが、押しても何も反応しなかったので、「あ、できないんだー」とずっと思っていたのですが、
        どうやら、押し方に問題があったようです。押す時間が短かったようなんですね。起動するときと同じ感覚で押してもダメだったようです。ほんの少し長く押せばスリープになるようなのです。起動の時はちょっと触れるだけでよかったので。<br>
        さて、ということは、残念なことに、無意味なものを作ってしまったなーという結論に至るようですな。電源ボタンの劣化を軽減する効果はあるかもですがね・・・・・・。<br>
        参考になるサイト<br>
        <a href="https://chi2npui2.mydns.jp/PowerButton/PowerButton.html">電源関係ボタンのショートカット6種類を作成する</a><br>
        

    </p>
</body>
</html>